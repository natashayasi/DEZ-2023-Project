{{ config(materilazied='table')}}

SELECT 
    g.apartment_id,
    g.area_id,	
    g.building_id,
    g.entity_subtype,
    g.entity_type,
    g.floor_id,
    g.geometry,
    g.site_id,
    g.unit_id,
    connectivity_balcony_distance_max,
    connectivity_balcony_distance_mean,
    connectivity_balcony_distance_median,
    connectivity_balcony_distance_min,
    connectivity_balcony_distance_p20,
    connectivity_balcony_distance_p80,
    connectivity_balcony_distance_stddev,
    connectivity_bathroom_distance_max,
    connectivity_bathroom_distance_mean,
    connectivity_bathroom_distance_median,
    connectivity_bathroom_distance_min,
    connectivity_bathroom_distance_p20,
    connectivity_bathroom_distance_p80,
    connectivity_bathroom_distance_stddev,
    connectivity_betweenness_centrality_max,
    connectivity_betweenness_centrality_mean,
    connectivity_betweenness_centrality_median,
    connectivity_betweenness_centrality_min,
    connectivity_betweenness_centrality_p20,
    connectivity_betweenness_centrality_p80,
    connectivity_betweenness_centrality_stddev,
    connectivity_closeness_centrality_max,
    connectivity_closeness_centrality_mean,
    connectivity_closeness_centrality_median,
    connectivity_closeness_centrality_min,
    connectivity_closeness_centrality_p20,
    connectivity_closeness_centrality_p80,
    connectivity_closeness_centrality_stddev,
    connectivity_eigen_centrality_max,
    connectivity_eigen_centrality_mean,
    connectivity_eigen_centrality_median,
    connectivity_eigen_centrality_min,
    connectivity_eigen_centrality_p20,
    connectivity_eigen_centrality_p80,
    connectivity_eigen_centrality_stddev,
    connectivity_entrance_door_distance_max,
    connectivity_entrance_door_distance_mean,
    connectivity_entrance_door_distance_median,
    connectivity_entrance_door_distance_min,
    connectivity_entrance_door_distance_p20,
    connectivity_entrance_door_distance_p80,
    connectivity_entrance_door_distance_stddev,
    connectivity_kitchen_distance_max,
    connectivity_kitchen_distance_mean,
    connectivity_kitchen_distance_median,
    connectivity_kitchen_distance_min,
    connectivity_kitchen_distance_p20,
    connectivity_kitchen_distance_p80,
    connectivity_kitchen_distance_stddev,
    connectivity_living_dining_distance_max,
    connectivity_living_dining_distance_mean,
    connectivity_living_dining_distance_median,
    connectivity_living_dining_distance_min,
    connectivity_living_dining_distance_p20,
    connectivity_living_dining_distance_p80,
    connectivity_living_dining_distance_stddev,
    connectivity_loggia_distance_max,
    connectivity_loggia_distance_mean,
    connectivity_loggia_distance_median,
    connectivity_loggia_distance_min,
    connectivity_loggia_distance_p20,
    connectivity_loggia_distance_p80,
    connectivity_loggia_distance_stddev,
    connectivity_room_distance_max,
    connectivity_room_distance_mean,
    connectivity_room_distance_median,
    connectivity_room_distance_min,
    connectivity_room_distance_p20,
    connectivity_room_distance_p80,
    connectivity_room_distance_stddev,
    floor_has_elevator,
    floor_number,
    layout_area,
    layout_area_type,
    layout_biggest_rectangle_length,
    layout_biggest_rectangle_width,
    layout_compactness,
    layout_connects_to_bathroom,
    layout_connects_to_private_outdoor,
    layout_door_perimeter,
    layout_has_bathtub,
    layout_has_entrance_door,
    layout_has_shower,
    layout_has_sink,
    layout_has_stairs,
    layout_has_toilet,
    layout_is_navigable,
    layout_mean_walllengths,
    layout_net_area,
    layout_number_of_doors,
    layout_number_of_windows,
    layout_open_perimeter,
    layout_perimeter,
    layout_railing_perimeter,
    layout_room_count,
    layout_std_walllengths,
    layout_window_perimeter,
    noise_traffic_day,
    noise_traffic_night,
    noise_train_day,
    noise_train_night,
    sun_201803210800_max,
    sun_201803210800_mean,
    sun_201803210800_median,
    sun_201803210800_min,
    sun_201803210800_p20,
    sun_201803210800_p80,
    sun_201803210800_stddev,
    sun_201803211000_max,
    sun_201803211000_mean,
    sun_201803211000_median,
    sun_201803211000_min,
    sun_201803211000_p20,
    sun_201803211000_p80,
    sun_201803211000_stddev,
    sun_201803211200_max,
    sun_201803211200_mean,
    sun_201803211200_median,
    sun_201803211200_min,
    sun_201803211200_p20,
    sun_201803211200_p80,
    sun_201803211200_stddev,
    sun_201803211400_max,
    sun_201803211400_mean,
    sun_201803211400_median,
    sun_201803211400_min,
    sun_201803211400_p20,
    sun_201803211400_p80,
    sun_201803211400_stddev,
    sun_201803211600_max,
    sun_201803211600_mean,
    sun_201803211600_median,
    sun_201803211600_min,
    sun_201803211600_p20,
    sun_201803211600_p80,
    sun_201803211600_stddev,
    sun_201803211800_max,
    sun_201803211800_mean,
    sun_201803211800_median,
    sun_201803211800_min,
    sun_201803211800_p20,
    sun_201803211800_p80,
    sun_201803211800_stddev,
    sun_201806210600_max,
    sun_201806210600_mean,
    sun_201806210600_median,
    sun_201806210600_min,
    sun_201806210600_p20,
    sun_201806210600_p80,
    sun_201806210600_stddev,
    sun_201806210800_max,
    sun_201806210800_mean,
    sun_201806210800_median,
    sun_201806210800_min,
    sun_201806210800_p20,
    sun_201806210800_p80,
    sun_201806210800_stddev,
    sun_201806211000_max,
    sun_201806211000_mean,
    sun_201806211000_median,
    sun_201806211000_min,
    sun_201806211000_p20,
    sun_201806211000_p80,
    sun_201806211000_stddev,
    sun_201806211200_max,
    sun_201806211200_mean,
    sun_201806211200_median,
    sun_201806211200_min,
    sun_201806211200_p20,
    sun_201806211200_p80,
    sun_201806211200_stddev,
    sun_201806211400_max,
    sun_201806211400_mean,
    sun_201806211400_median,
    sun_201806211400_min,
    sun_201806211400_p20,
    sun_201806211400_p80,
    sun_201806211400_stddev,
    sun_201806211600_max,
    sun_201806211600_mean,
    sun_201806211600_median,
    sun_201806211600_min,
    sun_201806211600_p20,
    sun_201806211600_p80,
    sun_201806211600_stddev,
    sun_201806211800_max,
    sun_201806211800_mean,
    sun_201806211800_median,
    sun_201806211800_min,
    sun_201806211800_p20,
    sun_201806211800_p80,
    sun_201806211800_stddev,
    sun_201806212000_max,
    sun_201806212000_mean,
    sun_201806212000_median,
    sun_201806212000_min,
    sun_201806212000_p20,
    sun_201806212000_p80,
    sun_201806212000_stddev,
    sun_201812211000_max,
    sun_201812211000_mean,
    sun_201812211000_median,
    sun_201812211000_min,
    sun_201812211000_p20,
    sun_201812211000_p80,
    sun_201812211000_stddev,
    sun_201812211200_max,
    sun_201812211200_mean,
    sun_201812211200_median,
    sun_201812211200_min,
    sun_201812211200_p20,
    sun_201812211200_p80,
    sun_201812211200_stddev,
    sun_201812211400_max,
    sun_201812211400_mean,
    sun_201812211400_median,
    sun_201812211400_min,
    sun_201812211400_p20,
    sun_201812211400_p80,
    sun_201812211400_stddev,
    sun_201812211600_max,
    sun_201812211600_mean,
    sun_201812211600_median,
    sun_201812211600_min,
    sun_201812211600_p20,
    sun_201812211600_p80,
    sun_201812211600_stddev,
    view_buildings_max,
    view_buildings_mean,
    view_buildings_median,
    view_buildings_min,
    view_buildings_p20,
    view_buildings_p80,
    view_buildings_stddev,
    view_greenery_max,
    view_greenery_mean,
    view_greenery_median,
    view_greenery_min,
    view_greenery_p20,
    view_greenery_p80,
    view_greenery_stddev,
    view_ground_max,
    view_ground_mean,
    view_ground_median,
    view_ground_min,
    view_ground_p20,
    view_ground_p80,
    view_ground_stddev,
    view_highways_max,
    view_highways_mean,
    view_highways_median,
    view_highways_min,
    view_highways_p20,
    view_highways_p80,
    view_highways_stddev,
    view_isovist_max,
    view_isovist_mean,
    view_isovist_median,
    view_isovist_min,
    view_isovist_p20,
    view_isovist_p80,
    view_isovist_stddev,
    view_mountains_class_2_max,
    view_mountains_class_2_mean,
    view_mountains_class_2_median,
    view_mountains_class_2_min,
    view_mountains_class_2_p20,
    view_mountains_class_2_p80,
    view_mountains_class_2_stddev,
    view_mountains_class_3_max,
    view_mountains_class_3_mean,
    view_mountains_class_3_median,
    view_mountains_class_3_min,
    view_mountains_class_3_p20,
    view_mountains_class_3_p80,
    view_mountains_class_3_stddev,
    view_mountains_class_4_max,
    view_mountains_class_4_mean,
    view_mountains_class_4_median,
    view_mountains_class_4_min,
    view_mountains_class_4_p20,
    view_mountains_class_4_p80,
    view_mountains_class_4_stddev,
    view_mountains_class_5_max,
    view_mountains_class_5_mean,
    view_mountains_class_5_median,
    view_mountains_class_5_min,
    view_mountains_class_5_p20,
    view_mountains_class_5_p80,
    view_mountains_class_5_stddev,
    view_mountains_class_6_max,
    view_mountains_class_6_mean,
    view_mountains_class_6_median,
    view_mountains_class_6_min,
    view_mountains_class_6_p20,
    view_mountains_class_6_p80,
    view_mountains_class_6_stddev,
    view_pedestrians_max,
    view_pedestrians_mean,
    view_pedestrians_median,
    view_pedestrians_min,
    view_pedestrians_p20,
    view_pedestrians_p80,
    view_pedestrians_stddev,
    view_primary_streets_max,
    view_primary_streets_mean,
    view_primary_streets_median,
    view_primary_streets_min,
    view_primary_streets_p20,
    view_primary_streets_p80,
    view_primary_streets_stddev,
    view_railway_tracks_max,
    view_railway_tracks_mean,
    view_railway_tracks_median,
    view_railway_tracks_min,
    view_railway_tracks_p20,
    view_railway_tracks_p80,
    view_railway_tracks_stddev,
    view_secondary_streets_max,
    view_secondary_streets_mean,
    view_secondary_streets_median,
    view_secondary_streets_min,
    view_secondary_streets_p20,
    view_secondary_streets_p80,
    view_secondary_streets_stddev,
    view_site_max,
    view_site_mean,
    view_site_median,
    view_site_min,
    view_site_p20,
    view_site_p80,
    view_site_stddev,
    view_sky_max,
    view_sky_mean,
    view_sky_median,
    view_sky_min,
    view_sky_p20,
    view_sky_p80,
    view_sky_stddev,
    view_tertiary_streets_max,
    view_tertiary_streets_mean,
    view_tertiary_streets_median,
    view_tertiary_streets_min,
    view_tertiary_streets_p20,
    view_tertiary_streets_p80,
    view_tertiary_streets_stddev,
    view_water_max,
    view_water_mean,
    view_water_median,
    view_water_min,
    view_water_p20,
    view_water_p80,
    view_water_stddev,
    window_noise_traffic_day_max,
    window_noise_traffic_day_min,
    window_noise_traffic_night_max,
    window_noise_traffic_night_min,
    window_noise_train_day_max,
    window_noise_train_day_min,
    window_noise_train_night_max,
    window_noise_train_night_min    


FROM 
    {{ ref('stg_geometries') }} g
INNER JOIN 
    {{ ref('stg_simulations')}} s
ON 
    g.apartment_id = s.apartment_id
    AND g.area_id = s.area_id
    AND g.building_id = s.building_id
    AND g.floor_id = s.floor_id
    AND g.site_id = s.site_id
    AND g.unit_id = s.unit_id
WHERE 
    g.apartment_id IS NOT NULL
